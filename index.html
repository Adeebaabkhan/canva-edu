<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Payslip Generator</title>
    <link rel="stylesheet" href="styles.css">
    <script src="faker.js"></script>
</head>
<body>
    <div class="container">
        <header class="app-header">
            <h1>Professional Payslip Generator</h1>
            <p class="subtitle">Generate realistic corporate payslips for educational verification purposes</p>
        </header>

        <div class="form-section">
            <div class="form-container">
                <div class="form-header">
                    <h2>Employee Information</h2>
                    <button type="button" id="auto-generate" class="auto-generate-btn">
                        <span class="icon">ðŸŽ²</span> Auto-Generate Data
                    </button>
                </div>

                <form id="payslip-form">
                    <div class="form-group">
                        <label for="name">Full Name:</label>
                        <input type="text" id="name" name="name" placeholder="Enter employee name" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="employee-id">Employee ID:</label>
                            <input type="text" id="employee-id" name="employee-id" placeholder="EMP001" required>
                        </div>

                        <div class="form-group">
                            <label for="country">Country:</label>
                            <select id="country" name="country" required>
                                <option value="">Select Country</option>
                                <option value="India">India</option>
                                <option value="USA">United States</option>
                                <option value="UK">United Kingdom</option>
                                <option value="Canada">Canada</option>
                                <option value="Australia">Australia</option>
                                <option value="Singapore">Singapore</option>
                                <option value="Philippines">Philippines</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="school">Select School:</label>
                        <select id="school" name="school" required>
                            <option value="">Please select a country first</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="department">Department:</label>
                            <input type="text" id="department" name="department" placeholder="Engineering" required>
                        </div>

                        <div class="form-group">
                            <label for="position">Position:</label>
                            <input type="text" id="position" name="position" placeholder="Software Developer" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="basic-salary">Basic Salary:</label>
                            <input type="number" id="basic-salary" name="basic-salary" placeholder="5000" min="1000" max="50000" required>
                        </div>

                        <div class="form-group">
                            <label for="pay-period">Pay Period:</label>
                            <input type="month" id="pay-period" name="pay-period" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="photo">Employee Photo:</label>
                        <input type="file" id="photo" name="photo" accept="image/*">
                        <div class="photo-preview" id="photo-preview"></div>
                    </div>

                    <button type="submit" class="generate-btn">Generate Payslip</button>
                </form>
            </div>
        </div>

        <div id="payslip-output" class="payslip-output hidden"></div>
    </div>
    <script>
        // Currency and tax configurations by country
        const countryConfig = {
            'India': {
                currency: 'â‚¹',
                taxRate: 0.10,
                providentFund: 0.12,
                locale: 'en-IN'
            },
            'USA': {
                currency: '$',
                taxRate: 0.22,
                socialSecurity: 0.062,
                medicare: 0.0145,
                locale: 'en-US'
            },
            'UK': {
                currency: 'Â£',
                taxRate: 0.20,
                nationalInsurance: 0.12,
                locale: 'en-GB'
            },
            'Canada': {
                currency: 'CAD $',
                taxRate: 0.15,
                cpp: 0.0545,
                ei: 0.0163,
                locale: 'en-CA'
            },
            'Australia': {
                currency: 'AUD $',
                taxRate: 0.19,
                superannuation: 0.11,
                locale: 'en-AU'
            },
            'Singapore': {
                currency: 'SGD $',
                taxRate: 0.15,
                cpf: 0.20,
                locale: 'en-SG'
            },
            'Philippines': {
                currency: 'â‚±',
                taxRate: 0.15,
                sss: 0.045,
                locale: 'en-PH'
            }
        };

        // Comprehensive School Database from canva.py
        const SCHOOLS_BY_COUNTRY = {
            "India": [
                "Delhi Public School, R.K. Puram, New Delhi",
                "The Doon School, Dehradun",
                "La Martiniere for Boys, Kolkata",
                "Sanskriti School, New Delhi",
                "Cathedral and John Connon School, Mumbai",
                "Mayo College, Ajmer",
                "Bishop Cotton School, Shimla",
                "Welham Girls' School, Dehradun",
                "Modern School, New Delhi",
                "St. Xavier's Collegiate School, Kolkata",
                "The Lawrence School, Sanawar",
                "Rishi Valley School, Chittoor",
                "Scindia School, Gwalior",
                "Woodstock School, Mussoorie",
                "St. Stephen's School, Chandigarh"
            ],
            "USA": [
                "Lincoln Elementary School, New York",
                "Groton School, Massachusetts",
                "Phillips Exeter Academy, New Hampshire",
                "The Lawrenceville School, New Jersey",
                "Choate Rosemary Hall, Connecticut",
                "Deerfield Academy, Massachusetts",
                "The Hotchkiss School, Connecticut",
                "Milton Academy, Massachusetts",
                "St. Paul's School, New Hampshire",
                "Andover Academy, Massachusetts",
                "Cranbrook Schools, Michigan",
                "The Thacher School, California",
                "Middlesex School, Massachusetts",
                "Cate School, California",
                "St. Mark's School, Massachusetts"
            ],
            "UK": [
                "Hillcrest Primary School, London",
                "Eton College, Berkshire",
                "Harrow School, London",
                "Winchester College, Hampshire",
                "Westminster School, London",
                "Charterhouse School, Surrey",
                "Rugby School, Warwickshire",
                "Marlborough College, Wiltshire",
                "Sherborne School, Dorset",
                "Tonbridge School, Kent",
                "Oundle School, Northamptonshire",
                "Bradfield College, Berkshire",
                "Radley College, Oxfordshire",
                "Uppingham School, Rutland",
                "Stowe School, Buckinghamshire"
            ],
            "Canada": [
                "Upper Canada College, Toronto",
                "St. George's School, Vancouver",
                "Bishop's College School, Quebec",
                "Ridley College, Ontario",
                "Trinity College School, Ontario",
                "Lakefield College School, Ontario",
                "Appleby College, Ontario",
                "Ashbury College, Ottawa",
                "St. Andrew's College, Aurora",
                "Brentwood College School, British Columbia",
                "Shawnigan Lake School, British Columbia",
                "Crescent School, Toronto",
                "The Country Day School, Ontario",
                "Royal St. George's College, Toronto",
                "Havergal College, Toronto"
            ],
            "Australia": [
                "Sydney Grammar School, New South Wales",
                "Melbourne Grammar School, Victoria",
                "Scotch College, Melbourne",
                "The King's School, Parramatta",
                "Geelong Grammar School, Victoria",
                "Brisbane Grammar School, Queensland",
                "Adelaide Hills School, South Australia",
                "St Peter's College, Adelaide",
                "Hale School, Perth",
                "Christ Church Grammar School, Western Australia",
                "Shore School, Sydney",
                "Knox Grammar School, New South Wales",
                "Trinity Grammar School, Melbourne",
                "Barker College, New South Wales",
                "Newington College, Sydney"
            ],
            "Singapore": [
                "Raffles Institution, Singapore",
                "Hwa Chong Institution, Singapore",
                "National Junior College, Singapore",
                "Victoria Junior College, Singapore",
                "Anglo-Chinese School, Singapore",
                "Singapore American School, Singapore",
                "United World College, Singapore",
                "Overseas Family School, Singapore",
                "Canadian International School, Singapore",
                "German European School, Singapore",
                "Australian International School, Singapore",
                "Chatsworth International School, Singapore",
                "Tanglin Trust School, Singapore",
                "NEXUS International School, Singapore",
                "Stamford American International School, Singapore"
            ],
            "Philippines": [
                "Ateneo de Manila University, Quezon City",
                "De La Salle University, Manila",
                "University of the Philippines, Diliman",
                "Xavier School, San Juan",
                "Immaculate Conception Academy, Greenhills",
                "Miriam College, Quezon City",
                "St. Scholastica's College, Manila",
                "Assumption College, Makati",
                "Philippine Science High School, Quezon City",
                "International School Manila, Taguig",
                "British School Manila, Taguig",
                "Brent International School, Manila",
                "Southville International School, Las PiÃ±as",
                "Faith Academy, Manila",
                "Colegio San Agustin, Makati"
            ]
        };

        // Function to populate schools based on selected country
        function populateSchools(country) {
            const schoolSelect = document.getElementById('school');
            schoolSelect.innerHTML = '<option value="">Select a school</option>';
            
            if (country && SCHOOLS_BY_COUNTRY[country]) {
                SCHOOLS_BY_COUNTRY[country].forEach(school => {
                    const option = document.createElement('option');
                    option.value = school;
                    option.textContent = school;
                    schoolSelect.appendChild(option);
                });
            } else {
                schoolSelect.innerHTML = '<option value="">Please select a country first</option>';
            }
        }

        // Function to extract school name and location
        function parseSchool(schoolString) {
            const parts = schoolString.split(', ');
            const schoolName = parts[0];
            const location = parts.slice(1).join(', ');
            return { name: schoolName, location: location };
        }

        // Initialize Faker for different locales
        function initializeFaker(country) {
            switch(country) {
                case 'UK':
                    faker.locale = 'en_GB';
                    break;
                case 'Canada':
                    faker.locale = 'en_CA';
                    break;
                default:
                    faker.locale = 'en_US';
            }
        }

        // Auto-generate realistic employee data
        function autoGenerateData() {
            // First select a random country if none selected
            const countrySelect = document.getElementById('country');
            if (!countrySelect.value) {
                const countries = ['India', 'USA', 'UK', 'Canada', 'Australia', 'Singapore', 'Philippines'];
                countrySelect.value = faker.random.arrayElement(countries);
                populateSchools(countrySelect.value);
            }
            
            const country = countrySelect.value;
            initializeFaker(country);

            // Generate realistic data
            const firstName = faker.name.firstName();
            const lastName = faker.name.lastName();
            const fullName = `${firstName} ${lastName}`;
            
            document.getElementById('name').value = fullName;
            document.getElementById('employee-id').value = `EMP${faker.datatype.number({min: 1000, max: 9999})}`;
            document.getElementById('department').value = faker.random.arrayElement([
                'Engineering', 'Marketing', 'Sales', 'HR', 'Finance', 'Operations', 'IT Support'
            ]);
            document.getElementById('position').value = faker.random.arrayElement([
                'Software Developer', 'Senior Developer', 'Marketing Manager', 'Sales Representative',
                'HR Specialist', 'Financial Analyst', 'System Administrator', 'Project Manager'
            ]);
            document.getElementById('basic-salary').value = faker.datatype.number({min: 3000, max: 15000});
            
            // Select a random school
            const schoolSelect = document.getElementById('school');
            if (SCHOOLS_BY_COUNTRY[country] && SCHOOLS_BY_COUNTRY[country].length > 0) {
                schoolSelect.value = faker.random.arrayElement(SCHOOLS_BY_COUNTRY[country]);
            }
            
            // Set current month
            const currentDate = new Date();
            const monthString = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
            document.getElementById('pay-period').value = monthString;
        }

        // Calculate salary breakdown
        function calculateSalary(basicSalary, country) {
            const config = countryConfig[country];
            const gross = parseFloat(basicSalary);
            
            let deductions = {};
            let totalDeductions = 0;

            // Calculate tax
            const incomeTax = gross * config.taxRate;
            deductions['Income Tax'] = incomeTax;
            totalDeductions += incomeTax;

            // Country-specific deductions
            if (country === 'India') {
                const providentFund = gross * config.providentFund;
                deductions['Provident Fund'] = providentFund;
                totalDeductions += providentFund;
            } else if (country === 'USA') {
                const socialSecurity = gross * config.socialSecurity;
                const medicare = gross * config.medicare;
                deductions['Social Security'] = socialSecurity;
                deductions['Medicare'] = medicare;
                totalDeductions += socialSecurity + medicare;
            } else if (country === 'UK') {
                const nationalInsurance = gross * config.nationalInsurance;
                deductions['National Insurance'] = nationalInsurance;
                totalDeductions += nationalInsurance;
            } else if (country === 'Canada') {
                const cpp = gross * config.cpp;
                const ei = gross * config.ei;
                deductions['CPP'] = cpp;
                deductions['Employment Insurance'] = ei;
                totalDeductions += cpp + ei;
            } else if (country === 'Australia') {
                const superannuation = gross * config.superannuation;
                deductions['Superannuation'] = superannuation;
                totalDeductions += superannuation;
            } else if (country === 'Singapore') {
                const cpf = gross * config.cpf;
                deductions['CPF'] = cpf;
                totalDeductions += cpf;
            } else if (country === 'Philippines') {
                const sss = gross * config.sss;
                deductions['SSS'] = sss;
                totalDeductions += sss;
            }

            const netSalary = gross - totalDeductions;

            return {
                gross,
                deductions,
                totalDeductions,
                netSalary,
                currency: config.currency
            };
        }

        // Format currency
        function formatCurrency(amount, country) {
            const config = countryConfig[country];
            const currencyMap = {
                'India': 'INR',
                'USA': 'USD',
                'UK': 'GBP',
                'Canada': 'CAD',
                'Australia': 'AUD',
                'Singapore': 'SGD',
                'Philippines': 'PHP'
            };
            
            return new Intl.NumberFormat(config.locale, {
                style: 'currency',
                currency: currencyMap[country] || 'USD'
            }).format(amount);
        }

        // Generate professional payslip
        function generatePayslip(formData, photoUrl) {
            const country = formData.get('country');
            const schoolString = formData.get('school');
            const basicSalary = formData.get('basic-salary');
            const salaryBreakdown = calculateSalary(basicSalary, country);
            
            // Parse school information
            const school = parseSchool(schoolString);
            const schoolInitials = school.name.split(' ').map(word => word[0]).join('').substring(0, 2).toUpperCase();
            
            const payPeriod = new Date(formData.get('pay-period') + '-01');
            const payPeriodStr = payPeriod.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long' 
            });

            return `
                <div class="payslip-document">
                    <div class="company-header">
                        <div class="company-logo">
                            <div class="logo-circle">${schoolInitials}</div>
                        </div>
                        <div class="company-info">
                            <h1>${school.name.toUpperCase()}</h1>
                            <p>Educational Excellence & Professional Development</p>
                            <div class="company-details">
                                <p>${school.location}</p>
                                <p>Education | Training | Professional Services</p>
                            </div>
                        </div>
                    </div>

                    <div class="payslip-header">
                        <h2>PAYSLIP / SALARY STATEMENT</h2>
                        <div class="pay-period">Pay Period: ${payPeriodStr} | Employee ID: ${formData.get('employee-id')}</div>
                    </div>

                    <div class="employee-section">
                        <div class="employee-info">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>Employee Name:</label>
                                    <span>${formData.get('name')}</span>
                                </div>
                                <div class="info-item">
                                    <label>Employee ID:</label>
                                    <span>${formData.get('employee-id')}</span>
                                </div>
                                <div class="info-item">
                                    <label>Department:</label>
                                    <span>${formData.get('department')}</span>
                                </div>
                                <div class="info-item">
                                    <label>Position:</label>
                                    <span>${formData.get('position')}</span>
                                </div>
                                <div class="info-item">
                                    <label>Country:</label>
                                    <span>${formData.get('country')}</span>
                                </div>
                                <div class="info-item">
                                    <label>Pay Date:</label>
                                    <span>${new Date().toLocaleDateString()}</span>
                                </div>
                            </div>
                        </div>
                        ${photoUrl ? `<div class="employee-photo"><img src="${photoUrl}" alt="Employee Photo"></div>` : ''}
                    </div>

                    <div class="salary-section">
                        <div class="earnings-section">
                            <h3>Earnings</h3>
                            <div class="salary-item">
                                <span>Basic Salary</span>
                                <span class="amount">${formatCurrency(salaryBreakdown.gross, country)}</span>
                            </div>
                            <div class="salary-total">
                                <span>Gross Earnings</span>
                                <span class="amount">${formatCurrency(salaryBreakdown.gross, country)}</span>
                            </div>
                        </div>

                        <div class="deductions-section">
                            <h3>Deductions</h3>
                            ${Object.entries(salaryBreakdown.deductions).map(([key, value]) => 
                                `<div class="salary-item">
                                    <span>${key}</span>
                                    <span class="amount">-${formatCurrency(value, country)}</span>
                                </div>`
                            ).join('')}
                            <div class="salary-total deduction-total">
                                <span>Total Deductions</span>
                                <span class="amount">-${formatCurrency(salaryBreakdown.totalDeductions, country)}</span>
                            </div>
                        </div>
                    </div>

                    <div class="net-pay-section">
                        <div class="net-pay">
                            <span>Net Pay</span>
                            <span class="amount">${formatCurrency(salaryBreakdown.netSalary, country)}</span>
                        </div>
                    </div>

                    <div class="compliance-footer">
                        <div class="disclaimer">
                            <strong>FOR EDUCATIONAL VERIFICATION PURPOSES ONLY</strong>
                            <p>This document is generated for educational and training purposes. It should not be used for any official, legal, or financial proceedings.</p>
                        </div>
                        <div class="generation-info">
                            <p>Generated on: ${new Date().toLocaleString()}</p>
                            <p>Document ID: EDU-${Date.now()}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Handle photo preview
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('photo-preview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Photo Preview">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '';
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-generate button
            document.getElementById('auto-generate').addEventListener('click', autoGenerateData);
            
            // Photo upload
            document.getElementById('photo').addEventListener('change', handlePhotoUpload);
            
            // Country selection to populate schools
            document.getElementById('country').addEventListener('change', function(event) {
                populateSchools(event.target.value);
            });
            
            // Form submission
            document.getElementById('payslip-form').addEventListener('submit', function(event) {
                event.preventDefault();
                
                const formData = new FormData(event.target);
                const photoFile = document.getElementById('photo').files[0];
                let photoUrl = null;
                
                if (photoFile) {
                    photoUrl = URL.createObjectURL(photoFile);
                }
                
                const payslipHTML = generatePayslip(formData, photoUrl);
                const outputDiv = document.getElementById('payslip-output');
                
                outputDiv.innerHTML = payslipHTML;
                outputDiv.classList.remove('hidden');
                
                // Scroll to output
                outputDiv.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>